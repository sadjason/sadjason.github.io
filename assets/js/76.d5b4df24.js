(window.webpackJsonp=window.webpackJsonp||[]).push([[76],{175:function(v,o,_){"use strict";_.r(o);var e=_(0),r=Object(e.a)({},(function(){var v=this,o=v.$createElement,_=v._self._c||o;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h3",{attrs:{id:"frame-v-s-bounds-v-s-center"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#frame-v-s-bounds-v-s-center"}},[v._v("#")]),v._v(" frame v.s bounds v.s center")]),v._v(" "),_("p",[v._v("视图（"),_("code",[v._v("UIView")]),v._v("）有三种比较重要的布局属性："),_("code",[v._v("frame")]),v._v("，"),_("code",[v._v("bounds")]),v._v("，"),_("code",[v._v("center")]),v._v("，图层（"),_("code",[v._v("CALayer")]),v._v("）对应叫做："),_("code",[v._v("frame")]),v._v("，"),_("code",[v._v("bounds")]),v._v("，"),_("code",[v._v("position")]),v._v("。众所周知，视图是对图层的包装，名称虽然不完全相同，但都是指向相同的值，本文中"),_("code",[v._v("position")]),v._v("和"),_("code",[v._v("center")]),v._v("表示一个意思。")]),v._v(" "),_("p",[_("code",[v._v("bounds")]),v._v("和"),_("code",[v._v("position")]),v._v("是存储型属性，"),_("code",[v._v("bounds")]),v._v("标识了两个重要讯息：自身坐标系的起点（一般"),_("code",[v._v("(0, 0)")]),v._v("对应左上角）和图层的固有 size；而"),_("code",[v._v("position")]),v._v("标识了图层中心点相对于父图层坐标系的位置。")]),v._v(" "),_("p",[_("code",[v._v("frame")]),v._v("是计算型属性（虚拟属性），它的值根据"),_("code",[v._v("bounds")]),v._v("、"),_("code",[v._v("position")]),v._v("和"),_("code",[v._v("transform")]),v._v("计算而来。")]),v._v(" "),_("blockquote",[_("p",[v._v("Note: 这里的"),_("code",[v._v("transform")]),v._v("指的是图层（"),_("code",[v._v("CALayer")]),v._v("）的"),_("code",[v._v("transform")]),v._v("属性，而不是视图的"),_("code",[v._v("transform")]),v._v("属性。"),_("code",[v._v("UIView#transform")]),v._v("是"),_("code",[v._v("CATransform3D")]),v._v("类型，而"),_("code",[v._v("CALayer#transform")]),v._v("是"),_("code",[v._v("CGAffineTransform")]),v._v("类型，虽然类型不同，但根据我的理解，视图的"),_("code",[v._v("transform")]),v._v("和其图层的"),_("code",[v._v("transform")]),v._v("直接相关，换句话说，"),_("code",[v._v("UIView#transform")]),v._v("是"),_("code",[v._v("CALayer#transform")]),v._v("的简化版。")])]),v._v(" "),_("p",[v._v("当"),_("code",[v._v("CALayer#transform")]),v._v("的值等于"),_("code",[v._v("CATransform3DIdentity")]),v._v("，或者当"),_("code",[v._v("UIView#transform")]),v._v("的值等于"),_("code",[v._v("CGAffineTransformIdentity")]),v._v("时，"),_("code",[v._v("frame")]),v._v("、"),_("code",[v._v("position")]),v._v("和"),_("code",[v._v("bounds")]),v._v("存在着如下关系：")]),v._v(" "),_("ul",[_("li",[v._v("frame.origin = position - (bounds.size / 2.0)")]),v._v(" "),_("li",[v._v("frame.size = bounds.size")])]),v._v(" "),_("p",[v._v("在这种情况下：")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("position")]),v._v("和"),_("code",[v._v("bounds")]),v._v("彼此独立，改变任意一个值不会影响另外一个；")]),v._v(" "),_("li",[_("code",[v._v("frame.size")]),v._v("和"),_("code",[v._v("bounds.size")]),v._v("直接相关，修改任何一个会影响另外一个；")]),v._v(" "),_("li",[_("code",[v._v("frame.origin")]),v._v("和"),_("code",[v._v("position")]),v._v("直接相关，修改任何一个会影响另外一个；")]),v._v(" "),_("li",[_("code",[v._v("bounds.origin")]),v._v("不会对"),_("code",[v._v("frame")]),v._v("和"),_("code",[v._v("center")]),v._v("产生影响，但会影响到子图层的位置；")])]),v._v(" "),_("p",[v._v("当视图发生仿射变换时，比如平移、旋转、缩放，经验证发现："),_("code",[v._v("position")]),v._v("和"),_("code",[v._v("bounds")]),v._v("都不会改变，而"),_("code",[v._v("frame")]),v._v("会改变。并且当对图层进行缩放时，"),_("code",[v._v("frame.size")]),v._v("会和"),_("code",[v._v("bounds.size")]),v._v("不一致，详细说明参考"),_("a",{attrs:{href:"https://zsisme.gitbooks.io/ios-/content/chapter3/layout.html",target:"_blank",rel:"noopener noreferrer"}},[v._v("《iOS 核心动画高级技巧》"),_("OutboundLink")],1),v._v("。")]),v._v(" "),_("blockquote",[_("p",[v._v("P.S: 还没测试图层 3D 变换时"),_("code",[v._v("bounds")]),v._v("和"),_("code",[v._v("position")]),v._v("的变化情况，但我估计结果是一样的。")])]),v._v(" "),_("p",[v._v("我认为：把视图和图层的"),_("code",[v._v("frame")]),v._v("属性拿掉，iOS 布局系统也能照样运转，"),_("code",[v._v("frame")]),v._v("的作用不过是为了迎合大部分人的布局惯性思维罢了。")]),v._v(" "),_("h3",{attrs:{id:"anchorpoint"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#anchorpoint"}},[v._v("#")]),v._v(" anchorPoint")]),v._v(" "),_("p",[v._v("按理说，图层的"),_("code",[v._v("position")]),v._v("和"),_("code",[v._v("bounds.size")]),v._v("就足以告诉布局系统它在父图层中所占据的位置和面积了，前者指示了其"),_("strong",[v._v("中心点")]),v._v("的坐标，后者指示了其大小。")]),v._v(" "),_("p",[v._v("但问题出在"),_("strong",[v._v("中心点")]),v._v("上，图层的"),_("code",[v._v("position")]),v._v("之所以叫"),_("code",[v._v("position")]),v._v("而不叫"),_("code",[v._v("center")]),v._v("是有原因的。")]),v._v(" "),_("p",[v._v("可以想象图层和很多其他现实物体一样，有一个"),_("em",[v._v("把柄")]),v._v("，布局系统在摆放图层时，直接“拖”着这个"),_("em",[v._v("把柄")]),v._v("，把它杵到"),_("code",[v._v("position")]),v._v("对应的坐标上即可。在大多数时候，这个"),_("em",[v._v("把柄")]),v._v("所在的位置就是图层的中心点。然而，iOS 允许自定义图层的"),_("em",[v._v("把柄")]),v._v("位置，修改"),_("code",[v._v("CALayer#anchorPoint")]),v._v("值即可，"),_("code",[v._v("anchorPoint")]),v._v("是"),_("code",[v._v("CGPoint")]),v._v("类型，其默认值为"),_("code",[v._v("(0.5, 0.5)")]),v._v("（归一化值），当修改其值为"),_("code",[v._v("(0, 0)")]),v._v("，这意味着图层的"),_("em",[v._v("把柄")]),v._v("被移到左上角。换句话说，图层的"),_("code",[v._v("anchorPoint")]),v._v("属性值会影响到它的摆放位置，但该值和"),_("code",[v._v("position")]),v._v("、"),_("code",[v._v("bounds")]),v._v("彼此独立，没有任何关系，和"),_("code",[v._v("frame")]),v._v("更是谈不上啥关系了。")]),v._v(" "),_("p",[v._v("在什么时候需要修改"),_("code",[v._v("anchorPoint")]),v._v("属性值呢？"),_("a",{attrs:{href:"https://zsisme.gitbooks.io/ios-/content/chapter3/anchor.html",target:"_blank",rel:"noopener noreferrer"}},[v._v("《ios 核心动画高级技巧》"),_("OutboundLink")],1),v._v("有一个非常不错的应用实例。")]),v._v(" "),_("p",[_("code",[v._v("anchorPoint")]),v._v("所对应的位置，常常被称为图层的"),_("strong",[v._v("锚点")]),v._v("。")]),v._v(" "),_("p",[v._v("更值得一提的是，视图的仿射变换和图层的 3D 变换，都是围绕图层的锚点进行的。")]),v._v(" "),_("p",[v._v("具体来说，当"),_("code",[v._v("anchorPoint")]),v._v("的值为默认值时，对视图进行缩放或旋转，其中心点都不会发生迁移，如下：")]),v._v(" "),_("e-img",{attrs:{src:"/image/default-anchor-point.gif",alt:"Default Anchor Point"}}),v._v(" "),_("p",[v._v("当修改两个 view 的"),_("code",[v._v("anchorPoint")]),v._v("属性值为"),_("code",[v._v("(0.0, 0.0)")]),v._v("后，结果如下：")]),v._v(" "),_("e-img",{attrs:{src:"/image/new-anchor-point.gif",alt:"New Anchor Point"}}),v._v(" "),_("p",[v._v("显然，此时视图的缩放和旋转都以左上角为基准点。")]),v._v(" "),_("h3",{attrs:{id:"z-坐标轴"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#z-坐标轴"}},[v._v("#")]),v._v(" Z 坐标轴")]),v._v(" "),_("p",[_("code",[v._v("UIView")]),v._v("使用的是严格的二维坐标系，而"),_("code",[v._v("CALayer")]),v._v("存在于一个三维空间中。")]),v._v(" "),_("h3",{attrs:{id:"本文参考"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#本文参考"}},[v._v("#")]),v._v(" 本文参考")]),v._v(" "),_("ul",[_("li",[_("a",{attrs:{href:"http://stackoverflow.com/questions/5361369/uiview-frame-bounds-and-center",target:"_blank",rel:"noopener noreferrer"}},[v._v("UIView frame, bounds and center"),_("OutboundLink")],1)]),v._v(" "),_("li",[_("a",{attrs:{href:"https://zsisme.gitbooks.io/ios-/content/",target:"_blank",rel:"noopener noreferrer"}},[v._v("iOS 核心动画高级技巧"),_("OutboundLink")],1)])])],1)}),[],!1,null,null,null);o.default=r.exports}}]);